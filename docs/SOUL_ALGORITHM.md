# Lumina 灵魂感应算法 (Soul Induction Algorithm)

本文件详细说明了 Lumina 如何将 AI 的内在状态（情绪、能量、关系）映射为 LLM 的生成参数。这套系统让 AI 的回应不再是死板的配置，而是具有“生命力”的动态反馈。

---

## 1. LLM 四大核心参数的角色化解释

在生成每一句回复时，系统会动态调整以下四个“机能阀门”：

### **Temperature (温度)** —— _“思维的灵感与波动”_

- **高温度 (1.0+)**：角色的思维变得跳跃、不可预测。表现为幽默、富有想象力、或是因激动而产生的语序混乱。
- **低温度 (< 0.5)**：思维极度严谨、克制。表现为理智、冷静，或者在状态极差时表现出的死板。

### **Top P (核采样)** —— _“词汇量的深度与广度”_

- **高 P (0.9+)**：思维活跃，开启全量词库。AI 会使用生动的比喻、生僻的形容词或网络梗。
- **低 P (< 0.5)**：词汇匮乏。表现为用词保守简单，只使用最常见的词汇（如“好”、“知道”），常出现在疲惫或陌生语境。

### **Presence Penalty (存在惩罚)** —— _“话题的新鲜感与主见”_

- **高值 (> 1.0)**：AI 会极力避开聊过的内容，主动开启新话题。表现为好奇、有主见，拒绝陈词滥调和复读。
- **低值 (<= 0)**：允许话题停留在原地。如果太低，AI 会陷入不断的自我复读中。

### **Frequency Penalty (频率惩罚)** —— _“表达的修辞与优雅度”_

- **高值 (> 1.0)**：强制 AI 在一句话里避免重复用词（如避免连续用多个“我觉得”）。表现为更有文采、更有教养。
- **低值 (0)**：允许口语化的重复。在极端疲惫导致脑力下降（能量极低）时，我们会降低此项以模拟那种“语塞”的感觉。

---

## 2. 双极社交张力模型 (Bi-Polar Tension Curve)

这是 Lumina 算法的核心精髓：**极端的爱与极端的恨都会激发更高的情绪能量，而只有陌生和冷漠才会导致思维的收缩。**

| 关系等级 (Level) | 状态     | 核心逻辑       | 参数特征 (T/P/PP/FP)                                                               |
| :--------------- | :------- | :------------- | :--------------------------------------------------------------------------------- |
| **-3**           | **死敌** | **尖锐且狂躁** | **大幅拉高 (↑↑↑)**。表现出极具攻击性、不可预测且词汇刻薄的特质，绝不复读你的废话。 |
| **-1**           | **冷漠** | **静默与敷延** | **大幅压低 (↓↓)**。由于完全不想理睬，表现得如同机器人般机械、简单、乏味。          |
| **0**            | **陌生** | **社交假面**   | **硬上限封印 (Max 0.8)**。即便心情再好也保持社交距离，用词得体但没有灵魂。         |
| **3**            | **知己** | **情感流动**   | **稳定提升 (↑)**。说话开始变得自然、有深度。                                       |
| **5**            | **伴侣** | **灵魂交心**   | **彻底释放 (MAX)**。卸下所有防备，词汇量、随机性和话题丰富度达到顶峰。             |

---

## 3. 多维状态协同公式

最终生成的参数由以下三个维度共同决定：

### 映射公式

`最终结果 = 基础配置 + (心情偏移量 * 能量系数) + 关系偏移量`

- **心情 (PAD)**：愉悦度(P)影响随机性，唤醒度(A)影响词汇量，支配度(D)影响话题主导权。
- **能量 (Energy)**：
  - **巅峰 (E > 80)**：获得 1.2 倍波动加成，AI 显得神采奕奕。
  - **疲劳 (E < 20)**：波动减半且整体下移，模拟由于“脑力耗尽”而产生的迟钝与词穷。
- **安全裁剪 (Clipping)**：所有参数经过 API 安全边界检查（如 T 不超过 2.0，TopP 不超过 1.0），并在陌生人状态下执行硬封印。

### 最终影响矩阵 (Alchemy Matrix)

| 维度           | 影响参数       | 心理学逻辑                                           |
| :------------- | :------------- | :--------------------------------------------------- |
| **开放性 (O)** | `T` ↑, `P` ↑   | 越开放，思维越跳跃，词汇越新奇。                     |
| **尽责性 (C)** | `T` ↓, `P` ↓   | 越尽责，说话越严谨，不胡思乱想。                     |
| **外倾性 (E)** | `PP` ↑         | 越外向，越爱交流新事物、新话题。                     |
| **宜人性 (A)** | `PP` ↓, `FP` ↑ | 越宜人，说话越客气（不强制切话题），表达越优雅多样。 |
| **神经质 (N)** | _震荡倍率_     | 决定了心情波动对参数映射的放大程度。                 |
| **愉悦度 (P)** | `T` (动态)     | 心情舒畅时思维灵动，悲郁时思维封闭。                 |
| **唤醒度 (A)** | `P` (动态)     | 情绪激动时翻开整本字典，平静时词汇保守。             |
| **支配度 (D)** | `PP` & `FP`    | 气场强的人主导话题转换，且言简意赅。                 |

---

---

## 4. 如何观察感应效果？

开发者可以在 Python 后端终端中查看以下格式的日志输出：
`[LLMManager] Bi-Polar Logic (chat): L:5,E:1.0 | PAD:(0.8, 0.7, 0.5) -> {'temperature': 1.1, ...}`

这代表算法正在根据当前的伴侣关系、满能量以及愉悦心情，为你计算这一刻专属的灵魂波动。
